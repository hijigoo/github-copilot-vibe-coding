# 3. CSV 데이터를 HTML 리포트로 변환

## ⏰ 소요 시간
**20분**

---

## 📖 시나리오

PO인 여러분은 고객 만족도 설문조사 결과를 받았습니다.
50개의 응답이 CSV 파일로 정리되어 있습니다. 이제 경영진에게 보고할 차트와 리포트를 만들어야 합니다.

**현재 문제:**
- ❌ Excel로 수작업 분석하면 2-3시간 소요
- ❌ 차트 하나하나 만들기 번거로움
- ❌ 매번 같은 형식 반복

**Copilot으로 해결:**
- ✅ 10분 내에 리포트 완성
- ✅ 차트 4개 자동 생성
- ✅ HTML 리포트로 자동 변환

**💡 비개발자를 위한 설명:**
- CSV 파일 = 엑셀과 비슷한 데이터 파일
- Python 분석 = 엑셀의 100배 강력한 자동화 도구
- HTML 리포트 = 브라우저에서 보는 예쁜 보고서

---

## 📋 실습 재료: 샘플 CSV 파일

**샘플 파일 사용**
`data/customer_satisfaction_survey.csv` 파일을 사용하세요. (50건의 데이터 포함)

💡 **Tip**: 이미 준비된 데이터로 바로 분석을 시작할 수 있습니다!

---

## 📊 실습 1: CSV 데이터 분석 및 HTML 리포트 생성

### 🎯 목표
Copilot에게 명령하면 **자동으로 분석하고 리포트를 생성**합니다!

### Step 1: Copilot Chat 열기
```
⌘ + Shift + I (macOS) / Ctrl + Shift + I (Windows)
```

### Step 2: Copilot에게 명령하기

```
data/customer_satisfaction_survey.csv를 분석해서
HTML 리포트를 만들어줘:

1. 기본 통계:
   - 각 만족도 항목의 평균, 최소값, 최대값
   - 연령대별 평균 만족도
   - 직업별 평균 만족도

2. 시각화 (차트 생성):
   - 서비스 만족도 분포 막대그래프
   - 연령대별 평균 만족도 비교
   - 재이용 의향 분포 파이차트
   - 주요 불만사항 Top 10

3. HTML 리포트:
   - 제목: "고객 만족도 조사 결과"
   - 통계 표와 차트 포함
   - 예쁜 디자인 (CSS 스타일링: 그라데이션 배경, 카드 디자인)
   - 파일로 저장하고 브라우저에서 열기

모든 과정을 자동으로 실행해줘.
```

### Step 3: Copilot이 자동으로 실행

**💡 여러분은 아무것도 안 하셔도 됩니다!**
- Copilot Agent가 코드를 생성하고
- 자동으로 실행까지 완료하고
- HTML 리포트를 만들어냅니다

**자동 실행 과정** (Copilot이 알아서):
1. ✅ Python 코드 자동 생성
2. ✅ 필요한 라이브러리 자동 설치
3. ✅ 코드 자동 실행
4. ✅ HTML 리포트 자동 생성
5. ✅ 브라우저에서 자동으로 열기

**여러분이 할 일**: 결과 확인만!

---

### Step 4: 추가 요청 (선택사항)

리포트가 완성되면, 필요시 다음처럼 추가 요청:

**그래프 색상 변경**:
```
그래프 색상을 우리 브랜드 컬러(주황색 계열)로 변경해줘.
```

**추가 분석 요청**:
```
주요_불만사항 항목을 분석해서,
가장 많이 언급된 불만 Top 5를 표로 추가해줘.
```

**한글 폰트 문제 해결**:
```
차트에 한글이 깨져 보이면:
"한글 폰트 깨짐 문제를 해결해줘"
```

---

## 🎯 예상 결과물

[고객 만족도 조사 HTML 리포트 스크린샷]

---

## 🎨 실습 2: 리포트 커스터마이징

생성된 리포트를 개선해봅시다.

### 추가 기능 요청

**1. 인터랙티브 차트로 변경**:
```
위의 코드를 수정해서, 인터랙티브한 차트 라이브러리(plotly)를 사용해줘.
인터랙티브한 차트로 만들고, HTML에 임베드해줘.
```

**2. 엑셀 내보내기 기능 추가**:
```
분석 결과를 Excel 파일(.xlsx)로도 내보내는 기능을 추가해줘.
여러 시트로 구성:
- Sheet 1: 요약 통계
- Sheet 2: 연령대별 분석
- Sheet 3: 불만사항 목록
```

**3. 이메일 발송 기능**:
```
생성된 HTML 리포트를 이메일로 발송하는 함수를 추가해줘.
Gmail SMTP 사용, 첨부파일로 HTML과 이미지 포함.
```

---

## 🤖 실습 3: 자동화 스크립트 만들기

매주 반복되는 리포트 생성을 자동화해봅시다.

### 리포트 자동화 기능 추가하기

```
위의 코드를 개선해서, 다음 기능을 추가해줘:

1. 명령줄 인자로 CSV 파일 경로 받기
2. 리포트 출력 디렉토리 지정 가능
3. 날짜별로 리포트 자동 저장 (YYYY-MM-DD 형식)
4. 로그 파일 생성 (성공/실패 기록)
5. 에러 발생 시 상세 에러 메시지 출력

사용 예시:
python generate_report.py --input data.csv --output ./reports/

명령줄 옵션 처리 도구(argparse)를 사용해줘.
```

---

---

## � 예상 결과물

이 세션을 완료하면:
- ✅ 인터랙티브 HTML 리포트 파일
- ✅ 막대그래프, 파이차트가 포함된 시각화
- ✅ 자동화 스크립트 (`generate_report.py`)
- ✅ 브라우저에서 바로 열어볼 수 있는 결과물

**파일 구조:**
```
프로젝트/
├── customer_satisfaction_report.html  (리포트)
├── generate_report.py                (자동화 스크립트)
├── data/
│   └── customer_satisfaction_survey.csv
└── reports/
    └── YYYY-MM-DD_report.html
```

---

## 🎓 추가 도전 과제

---

## 🎓 추가 도전 과제

### 도전 1: 비교 리포트 생성
```
이번 달 데이터와 지난 달 데이터를 비교하는 리포트를 만들어줘.
증감률을 계산하고, 화살표(▲▼)로 표시해줘.
```

### 도전 2: 실시간 대시보드
```
웹 프레임워크(Flask)로 실시간 대시보드를 만들어줘.
CSV 파일이 업데이트되면 자동으로 리프레시되도록.
```

### 도전 3: PDF 내보내기
```
HTML 리포트를 PDF로 변환하는 기능을 추가해줘.
PDF 변환 라이브러리(pdfkit 또는 weasyprint) 사용.
```

---

## 📚 다음 세션 미리보기

**Session 7: 제품 아이디어 관리 도구 만들기**에서는:
- 비개발자도 만드는 웹 애플리케이션
- 아이디어/피드백/요구사항 관리 도구
- 데이터 저장 및 불러오기
- 실무에서 바로 사용 가능한 도구 완성

**소요 시간:** 40분  
**준비물:** 없음 (지금까지 배운 내용 활용!)

---
