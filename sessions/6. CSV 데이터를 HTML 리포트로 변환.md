# 3. CSV 데이터를 HTML 리포트로 변환
## ⏰ 소요 시간: 30분 (2:20 – 2:50)

---

## 🎯 학습 목표

이 세션을 마치면:
- CSV 데이터를 자동으로 읽고 분석
- 데이터 시각화 (막대그래프, 파이차트)
- HTML 리포트 자동 생성
- 브라우저에서 결과 확인 및 공유

---

## 🤔 CSV 데이터 분석이 뭔가요?

**쉽게 말하면**: 엑셀을 100배 더 강력하게 만든 도구를 사용하는 것입니다!

- **CSV 파일**: 엑셀과 비슷한 데이터 파일
- **Python 분석 도구**: 엑셀로는 힘든 작업을 자동으로
- **차트 자동 생성**: 클릭 몇 번이면 끝!

**비유하자면**:
- Excel = 수동 계산기
- Python 분석 = 자동 계산기 + 차트 마법사

---

## 📖 시나리오

> **상황**: PO인 여러분은 고객 만족도 설문조사 결과를 받았습니다. 50개의 응답이 CSV 파일(엑셀과 비슷)로 정리되어 있습니다. 이제 경영진에게 보고할 차트와 리포트를 만들어야 합니다.

**문제점**:
- Excel로 수작업 분석하면 2~3시간 소요
- 차트 하나하나 만들기 번거로움
- 매번 같은 형식 반복

**목표**:
- Copilot으로 10분 내에 리포트 완성
- 차트 4개 자동 생성
- 예쁜 HTML 리포트로 공유

---

## 📋 실습 재료: 샘플 CSV 파일

**샘플 파일 사용**
`data/customer_satisfaction_survey.csv` 파일을 사용하세요. (50건의 데이터 포함)

💡 **Tip**: 이미 준비된 데이터로 바로 분석을 시작할 수 있습니다!

---

## 💪 실습 1: CSV 데이터 분석 및 HTML 리포트 생성 (15분)

### 🎯 목표
Copilot에게 명령하면 **자동으로 분석하고 리포트를 생성**합니다!

### Step 1: Copilot Chat 열기
```
⌘ + Shift + I (macOS) / Ctrl + Shift + I (Windows)
```

### Step 2: Copilot에게 명령하기

```
data/customer_satisfaction_survey.csv를 분석해서
HTML 리포트를 만들어줘:

1. 기본 통계:
   - 각 만족도 항목의 평균, 최소값, 최대값
   - 연령대별 평균 만족도
   - 직업별 평균 만족도

2. 시각화 (차트 생성):
   - 서비스 만족도 분포 막대그래프
   - 연령대별 평균 만족도 비교
   - 재이용 의향 분포 파이차트
   - 주요 불만사항 Top 10

3. HTML 리포트:
   - 제목: "고객 만족도 조사 결과"
   - 통계 표와 차트 포함
   - 예쁜 디자인 (CSS 스타일링: 그라데이션 배경, 카드 디자인)
   - 파일로 저장하고 브라우저에서 열기

모든 과정을 자동으로 실행해줘.
```

### Step 3: Copilot이 자동으로 실행

**💡 여러분은 아무것도 안 하셔도 됩니다!**
- Copilot Agent가 코드를 생성하고
- 자동으로 실행까지 완료하고
- HTML 리포트를 만들어냅니다

**자동 실행 과정** (Copilot이 알아서):
1. ✅ Python 코드 자동 생성
2. ✅ 필요한 라이브러리 자동 설치
3. ✅ 코드 자동 실행
4. ✅ HTML 리포트 자동 생성
5. ✅ 브라우저에서 자동으로 열기

**여러분이 할 일**: 결과 확인만!

---

### Step 4: 추가 요청 (선택사항)

리포트가 완성되면, 필요시 다음처럼 추가 요청:

**그래프 색상 변경**:
```
그래프 색상을 우리 브랜드 컬러(주황색 계열)로 변경해줘.
```

**추가 분석 요청**:
```
주요_불만사항 항목을 분석해서,
가장 많이 언급된 불만 Top 5를 표로 추가해줘.
```

**한글 폰트 문제 해결**:
```
차트에 한글이 깨져 보이면:
"한글 폰트 깨짐 문제를 해결해줘"
```

---

## 🎯 예상 결과물: HTML 리포트

**💡 Copilot이 자동으로 만들어주는 리포트**

브라우저가 자동으로 열리면서 다음과 같은 리포트가 표시됩니다:

### 📊 리포트 구성

**1. 요약 통계**
- 각 만족도 항목의 평균, 최소값, 최대값
- 연령대별 평균 만족도
- 직업별 평균 만족도

**2. 시각화 차트**
- 📊 서비스 만족도 분포 (막대 그래프)
- 📊 연령대별 평균 만족도 (막대 그래프)
- 🥧 재이용 의향 분포 (원 그래프)
- 📊 주요 불만사항 Top 10 (막대 그래프)

**3. 인사이트**
- 가장 만족도가 높은 연령대
- 가장 많이 나온 불만사항
- 개선 필요 항목

### 🖼️ 실제 리포트 화면

> **💡 아래와 같은 리포트가 브라우저에 자동으로 열립니다**

**화면 구성:**

```
┌─────────────────────────────────────────────────┐
│   📊 고객 만족도 조사 결과                        │
│   서비스 품질 개선을 위한 사용자 피드백 분석       │
├─────────────────────────────────────────────────┤
│                                                 │
│  🎯 핵심 요약                                    │
│  • 총 응답 수: 50명                             │
│  • 평균 서비스 만족도: 3.68/5.0                 │
│  • 평균 재이용 의향: 3.62/5.0                   │
│  • 가장 만족도 높은 항목: 고객센터_만족도        │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  📈 1. 서비스 만족도 분포 (막대 그래프)          │
│  [주황색 막대 그래프 이미지]                     │
│                                                 │
│  💡 인사이트:                                   │
│  응답자의 64%가 4점 이상의 만족도를 보여,        │
│  전반적으로 긍정적인 평가를 받고 있습니다.        │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  📊 2. 연령대별 평균 만족도 (막대 그래프)        │
│  [주황색 막대 그래프 이미지]                     │
│                                                 │
│  💡 인사이트:                                   │
│  30대 사용자의 만족도가 가장 높으며 (3.9점),     │
│  20대 사용자 대상 개선이 필요합니다 (3.5점).     │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  🥧 3. 재이용 의향 분포 (원 그래프)              │
│  [주황색 원 그래프 이미지]                       │
│                                                 │
│  💡 인사이트:                                   │
│  재이용 의향 4점 이상 응답자가 60%로,            │
│  높은 고객 충성도를 보여주고 있습니다.            │
│                                                 │
├─────────────────────────────────────────────────┤
│                                                 │
│  🔴 주요 불만사항 Top 5 (표)                     │
│  1. 가격이 비쌈 - 8회                           │
│  2. 검색 속도 느림 - 5회                        │
│  3. UI가 구식 - 4회                             │
│  4. 리뷰 신뢰도 낮음 - 3회                      │
│  5. 할인 부족 - 3회                             │
│                                                 │
└─────────────────────────────────────────────────┘
```

**실제로는 컬러풀한 디자인 + 그라데이션 배경 + 그래프 이미지가 포함됩니다!**

> 📸 **스크린샷 추가 예정**: 실제 리포트 화면 캡처 이미지

---

## 💪 실습 2: 리포트 커스터마이징 (10분)

생성된 리포트를 개선해봅시다.

### 추가 기능 요청

**1. 인터랙티브 차트로 변경**:
```
위의 코드를 수정해서, 인터랙티브한 차트 라이브러리(plotly)를 사용해줘.
인터랙티브한 차트로 만들고, HTML에 임베드해줘.
```

**2. 엑셀 내보내기 기능 추가**:
```
분석 결과를 Excel 파일(.xlsx)로도 내보내는 기능을 추가해줘.
여러 시트로 구성:
- Sheet 1: 요약 통계
- Sheet 2: 연령대별 분석
- Sheet 3: 불만사항 목록
```

**3. 이메일 발송 기능**:
```
생성된 HTML 리포트를 이메일로 발송하는 함수를 추가해줘.
Gmail SMTP 사용, 첨부파일로 HTML과 이미지 포함.
```

---

## 💪 실습 3: 자동화 스크립트 만들기 (5분)

매주 반복되는 리포트 생성을 자동화해봅시다.

### 프롬프트

```
위의 코드를 개선해서, 다음 기능을 추가해줘:

1. 명령줄 인자로 CSV 파일 경로 받기
2. 리포트 출력 디렉토리 지정 가능
3. 날짜별로 리포트 자동 저장 (YYYY-MM-DD 형식)
4. 로그 파일 생성 (성공/실패 기록)
5. 에러 발생 시 상세 에러 메시지 출력

사용 예시:
python generate_report.py --input data.csv --output ./reports/

명령줄 옵션 처리 도구(argparse)를 사용해줘.
```

---

## 🎉 실습 완료!

축하합니다! 이제 여러분은:
- ✅ CSV 데이터를 자동으로 분석하고 시각화할 수 있습니다
- ✅ 전문가 수준의 HTML 리포트를 생성할 수 있습니다
- ✅ 코드를 커스터마이징하고 자동화할 수 있습니다
- ✅ 비개발자도 데이터 분석 작업을 수행할 수 있습니다!

---

## 💡 실무 활용 팁

### 1. 정기 리포트 자동화
```bash
# macOS/Linux: cron 작업 설정
0 9 * * 1 python /path/to/generate_report.py --input weekly_data.csv

# Windows: 작업 스케줄러 사용
```

### 2. 다양한 데이터 소스 지원
- Google Sheets API 연동
- 데이터베이스 직접 쿼리
- API에서 데이터 가져오기

### 3. 리포트 템플릿화
- 회사 CI/CD에 맞게 디자인 변경
- 로고 및 브랜드 요소 추가
- 부서별 커스텀 템플릿 생성

### 4. 대시보드로 확장
- 여러 리포트를 하나의 대시보드로 통합
- 실시간 데이터 업데이트
- 필터링 및 드릴다운 기능

---

## 🎓 추가 도전 과제

### 도전 1: 비교 리포트 생성
```
이번 달 데이터와 지난 달 데이터를 비교하는 리포트를 만들어줘.
증감률을 계산하고, 화살표(▲▼)로 표시해줘.
```

### 도전 2: 실시간 대시보드
```
웹 프레임워크(Flask)로 실시간 대시보드를 만들어줘.
CSV 파일이 업데이트되면 자동으로 리프레시되도록.
```

### 도전 3: PDF 내보내기
```
HTML 리포트를 PDF로 변환하는 기능을 추가해줘.
PDF 변환 라이브러리(pdfkit 또는 weasyprint) 사용.
```

---

## 🔍 자주 묻는 질문

### Q1: Python을 한 번도 써본 적이 없는데 괜찮나요?
**A**: 네! Copilot이 모든 코드를 작성해줍니다. 실행만 하면 됩니다.

### Q2: CSV 파일 형식이 다르면 어떻게 하나요?
**A**: Copilot에게 실제 CSV 샘플을 보여주고 코드 수정 요청:
```
내 CSV 파일은 다음과 같은 구조야:
[샘플 데이터 붙여넣기]

이 형식에 맞게 코드를 수정해줘.
```

### Q3: 차트를 PowerPoint에 넣고 싶어요
**A**: 차트 이미지(PNG)를 PPT에 직접 삽입하거나:
```
차트를 SVG 형식으로 저장하는 옵션을 추가해줘.
고해상도로 출력되도록.
```

---

## 📚 다음 세션 미리보기

**Session 6: 제품 관리 도구 만들기**에서는:
- PO를 위한 실무 도구 제작
- 아이디어/피드백/요구사항 관리
- TXT 파일로 저장/불러오기
- 카테고리와 우선순위 분류

**Session 7: 실무 적용 & Q&A**에서는:
- 오늘 배운 내용 종합 정리
- 실무 적용 시나리오
- 궁금한 점 모두 해결
- 다음 학습 방향 제시

준비물: 없음 (바로 시작 가능)

---

**이전**: [← Session 4: UX 리서치 분석](session4_ux_research.md)  
**다음**: [Session 6: 웹 페이지 만들기 →](session6_web_app.md)

---
